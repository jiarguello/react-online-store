{"ast":null,"code":"import _regeneratorRuntime from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/jhon/Projetos/React-Online-Store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Link}from'react-router-dom';import ListOfCategories from'../Components/ListOfCategories';import SearchBar from'../Components/SearchBar';import ProductCard from'../Components/ProductCard';import*as api from'../services/api';var Home=/*#__PURE__*/function(_React$Component){_inherits(Home,_React$Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.state={searchText:'',productsList:[],categories:[],addItem:[]};_this.handleSearchTextChange=_this.handleSearchTextChange.bind(_assertThisInitialized(_this));_this.fetchApiSearch=_this.fetchApiSearch.bind(_assertThisInitialized(_this));_this.fetchByCategoryId=_this.fetchByCategoryId.bind(_assertThisInitialized(_this));_this.addItemCart=_this.addItemCart.bind(_assertThisInitialized(_this));return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;api.getCategories().then(function(response){return _this2.setState({categories:response});});}},{key:\"handleSearchTextChange\",value:function handleSearchTextChange(_ref){var target=_ref.target;var value=target.value;this.setState({searchText:value});}},{key:\"addItemCart\",value:function addItemCart(id){var _this$state=this.state,productsList=_this$state.productsList,addItem=_this$state.addItem;var itemProduct=productsList.find(function(item){return id===item.id;});itemProduct.quantity=1;this.setState({addItem:[].concat(_toConsumableArray(addItem),[itemProduct])});}},{key:\"fetchByCategoryId\",value:function(){var _fetchByCategoryId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(categoryId){var fetchList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return api.getProductsFromCategoryAndQuery(categoryId,'');case 2:fetchList=_context.sent;this.setState({productsList:fetchList.results});case 4:case\"end\":return _context.stop();}}},_callee,this);}));function fetchByCategoryId(_x){return _fetchByCategoryId.apply(this,arguments);}return fetchByCategoryId;}()},{key:\"fetchApiSearch\",value:function(){var _fetchApiSearch=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var searchText,fetchList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:searchText=this.state.searchText;_context2.next=3;return api.getProductsFromCategoryAndQuery('',searchText);case 3:fetchList=_context2.sent;if(!fetchList.results.length){this.setState({showMessage:true});}else{this.setState({productsList:fetchList.results,showMessage:false});}case 5:case\"end\":return _context2.stop();}}},_callee2,this);}));function fetchApiSearch(){return _fetchApiSearch.apply(this,arguments);}return fetchApiSearch;}()},{key:\"render\",value:function render(){var _this$state2=this.state,productsList=_this$state2.productsList,showMessage=_this$state2.showMessage,categories=_this$state2.categories,addItem=_this$state2.addItem;var emptySearchMessage=/*#__PURE__*/React.createElement(\"p\",null,\"Nenhum produto foi encontrado\");return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(SearchBar,{onSearchTextChange:this.handleSearchTextChange,onClickSearch:this.fetchApiSearch}),/*#__PURE__*/React.createElement(ListOfCategories,{categories:categories,onClickSelectedCategory:this.fetchByCategoryId}),showMessage?emptySearchMessage:/*#__PURE__*/React.createElement(ProductCard,{products:productsList,onClick:this.addItemCart,cartItens:addItem}),/*#__PURE__*/React.createElement(\"button\",{type:\"button\"},/*#__PURE__*/React.createElement(Link,{to:{pathname:'/shopping-cart',state:addItem},\"data-testid\":\"shopping-cart-button\"},\"Carrinho\",/*#__PURE__*/React.createElement(\"span\",{\"data-testid\":\"shopping-cart-size\"},addItem.length))));}}]);return Home;}(React.Component);export default Home;","map":{"version":3,"sources":["/home/jhon/Projetos/React-Online-Store/src/Pages/Home.jsx"],"names":["React","Link","ListOfCategories","SearchBar","ProductCard","api","Home","props","state","searchText","productsList","categories","addItem","handleSearchTextChange","bind","fetchApiSearch","fetchByCategoryId","addItemCart","getCategories","then","response","setState","target","value","id","itemProduct","find","item","quantity","categoryId","getProductsFromCategoryAndQuery","fetchList","results","length","showMessage","emptySearchMessage","pathname","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport ListOfCategories from '../Components/ListOfCategories';\nimport SearchBar from '../Components/SearchBar';\nimport ProductCard from '../Components/ProductCard';\nimport * as api from '../services/api';\n\nclass Home extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: '',\n      productsList: [],\n      categories: [],\n      addItem: [],\n    };\n    this.handleSearchTextChange = this.handleSearchTextChange.bind(this);\n    this.fetchApiSearch = this.fetchApiSearch.bind(this);\n    this.fetchByCategoryId = this.fetchByCategoryId.bind(this);\n    this.addItemCart = this.addItemCart.bind(this);\n  }\n\n  componentDidMount() {\n    api.getCategories()\n      .then((response) => this.setState({ categories: response }));\n  }\n\n  handleSearchTextChange({ target }) {\n    const { value } = target;\n    this.setState({\n      searchText: value,\n    });\n  }\n\n  addItemCart(id) {\n    const { productsList, addItem } = this.state;\n    const itemProduct = productsList.find((item) => id === item.id);\n    itemProduct.quantity = 1;\n    this.setState({\n      addItem: [...addItem, itemProduct],\n    });\n  }\n\n  async fetchByCategoryId(categoryId) {\n    const fetchList = await api.getProductsFromCategoryAndQuery(categoryId, '');\n    this.setState({\n      productsList: fetchList.results,\n    });\n  }\n\n  async fetchApiSearch() {\n    const { searchText } = this.state;\n    const fetchList = await api.getProductsFromCategoryAndQuery('', searchText);\n\n    if (!fetchList.results.length) {\n      this.setState({\n        showMessage: true,\n      });\n    } else {\n      this.setState({\n        productsList: fetchList.results,\n        showMessage: false,\n      });\n    }\n  }\n\n  render() {\n    const { productsList, showMessage, categories, addItem } = this.state;\n    const emptySearchMessage = <p>Nenhum produto foi encontrado</p>;\n    return (\n      <div>\n        <SearchBar\n          onSearchTextChange={ this.handleSearchTextChange }\n          onClickSearch={ this.fetchApiSearch }\n        />\n        <ListOfCategories\n          categories={ categories }\n          onClickSelectedCategory={ this.fetchByCategoryId }\n        />\n        {\n          showMessage ? emptySearchMessage : <ProductCard\n            products={ productsList }\n            onClick={ this.addItemCart }\n            cartItens={ addItem }\n          />\n        }\n        <button type=\"button\">\n          <Link\n            to={ {\n              pathname: '/shopping-cart',\n              state: addItem,\n            } }\n            data-testid=\"shopping-cart-button\"\n          >\n            Carrinho\n            <span data-testid=\"shopping-cart-size\">{ addItem.length }</span>\n          </Link>\n        </button>\n      </div>\n    );\n  }\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}