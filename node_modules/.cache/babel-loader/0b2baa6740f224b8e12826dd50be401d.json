{"ast":null,"code":"import _regeneratorRuntime from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/jhon/Projetos/react-online-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Link}from'react-router-dom';import ListOfCategories from'../Components/ListOfCategories';import SearchBar from'../Components/SearchBar';import ProductCard from'../Components/ProductCard';import*as api from'../services/api';import*as S from'../CSS/S.Home';import Cart from'../Images/carrinho.png';var Home=/*#__PURE__*/function(_React$Component){_inherits(Home,_React$Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.state={searchText:'',productsList:[],categories:[],hidden:true,toggle:false};_this.addItemCart=_this.addItemCart.bind(_assertThisInitialized(_this));_this.fetchApiSearch=_this.fetchApiSearch.bind(_assertThisInitialized(_this));_this.fetchByCategoryId=_this.fetchByCategoryId.bind(_assertThisInitialized(_this));_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSearchTextChange=_this.handleSearchTextChange.bind(_assertThisInitialized(_this));_this.toggle=_this.toggle.bind(_assertThisInitialized(_this));return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(!localStorage.getItem('shoppingCart')){localStorage.setItem('shoppingCart',JSON.stringify([]));}api.getCategories().then(function(response){return _this2.setState({categories:response});});}},{key:\"addItemCart\",value:function addItemCart(product){var currentCart=JSON.parse(localStorage.getItem('shoppingCart'));var isOnCart=currentCart.some(function(item){return item.id===product.id;});if(isOnCart){currentCart.find(function(elem){if(elem.id===product.id){var quantity=elem.quantity,availableQuantity=elem.available_quantity;if(quantity<availableQuantity){elem.quantity=quantity+1;localStorage.setItem('shoppingCart',JSON.stringify(currentCart));}}});}else{product.quantity=1;var newCart=[].concat(_toConsumableArray(currentCart),[product]);localStorage.setItem('shoppingCart',JSON.stringify(newCart));}}},{key:\"fetchApiSearch\",value:function(){var _fetchApiSearch=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var searchText,fetchList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:searchText=this.state.searchText;_context.next=3;return api.getProductsFromCategoryAndQuery('',searchText);case 3:fetchList=_context.sent;if(!fetchList.results.length){this.setState({showMessage:true});}else{this.setState({productsList:fetchList.results,showMessage:false});}case 5:case\"end\":return _context.stop();}}},_callee,this);}));function fetchApiSearch(){return _fetchApiSearch.apply(this,arguments);}return fetchApiSearch;}()},{key:\"fetchByCategoryId\",value:function(){var _fetchByCategoryId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(categoryId){var fetchList;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return api.getProductsFromCategoryAndQuery(categoryId,'');case 2:fetchList=_context2.sent;this.setState({productsList:fetchList.results});case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function fetchByCategoryId(_x){return _fetchByCategoryId.apply(this,arguments);}return fetchByCategoryId;}()},{key:\"handleSearchTextChange\",value:function handleSearchTextChange(_ref){var target=_ref.target;var value=target.value;this.setState({searchText:value});}},{key:\"handleChange\",value:function handleChange(){var hidden=this.state.hidden;this.setState({hidden:!hidden});}},{key:\"toggle\",value:function toggle(product){var toggle=this.state.toggle;this.addItemCart(product);this.setState({toggle:!toggle});}},{key:\"render\",value:function render(){var shoppingCart=JSON.parse(localStorage.getItem('shoppingCart'));var _this$state=this.state,productsList=_this$state.productsList,showMessage=_this$state.showMessage,categories=_this$state.categories,hidden=_this$state.hidden;var emptySearchMessage=/*#__PURE__*/React.createElement(\"p\",null,\"Nenhum produto foi encontrado\");return/*#__PURE__*/React.createElement(S.Main,null,/*#__PURE__*/React.createElement(S.Header,null,/*#__PURE__*/React.createElement(S.ButtonMenu,{type:\"button\",onClick:this.handleChange}),/*#__PURE__*/React.createElement(SearchBar,{onSearchTextChange:this.handleSearchTextChange,onClickSearch:this.fetchApiSearch}),/*#__PURE__*/React.createElement(S.Div,null,/*#__PURE__*/React.createElement(Link,{to:\"/shopping-cart\"},/*#__PURE__*/React.createElement(S.Span,null,shoppingCart!==null?shoppingCart.length:0),/*#__PURE__*/React.createElement(S.CartIMG,{src:Cart,alt:\"shopping cart\"})))),/*#__PURE__*/React.createElement(ListOfCategories,{categories:categories,hidden:hidden,onClickSelectedCategory:this.fetchByCategoryId}),showMessage?emptySearchMessage:/*#__PURE__*/React.createElement(ProductCard,{products:productsList,toggle:this.toggle}));}}]);return Home;}(React.Component);export default Home;","map":{"version":3,"sources":["/home/jhon/Projetos/react-online-store/src/Pages/Home.jsx"],"names":["React","Link","ListOfCategories","SearchBar","ProductCard","api","S","Cart","Home","props","state","searchText","productsList","categories","hidden","toggle","addItemCart","bind","fetchApiSearch","fetchByCategoryId","handleChange","handleSearchTextChange","localStorage","getItem","setItem","JSON","stringify","getCategories","then","response","setState","product","currentCart","parse","isOnCart","some","item","id","find","elem","quantity","availableQuantity","available_quantity","newCart","getProductsFromCategoryAndQuery","fetchList","results","length","showMessage","categoryId","target","value","shoppingCart","emptySearchMessage","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\nimport ListOfCategories from '../Components/ListOfCategories';\nimport SearchBar from '../Components/SearchBar';\nimport ProductCard from '../Components/ProductCard';\nimport * as api from '../services/api';\nimport * as S from '../CSS/S.Home';\nimport Cart from '../Images/carrinho.png';\n\nclass Home extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: '',\n      productsList: [],\n      categories: [],\n      hidden: true,\n      toggle: false,\n    };\n    this.addItemCart = this.addItemCart.bind(this);\n    this.fetchApiSearch = this.fetchApiSearch.bind(this);\n    this.fetchByCategoryId = this.fetchByCategoryId.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSearchTextChange = this.handleSearchTextChange.bind(this);\n    this.toggle = this.toggle.bind(this);\n  }\n\n  componentDidMount() {\n    if (!localStorage.getItem('shoppingCart')) {\n      localStorage.setItem('shoppingCart', JSON.stringify([]));\n    }\n    api.getCategories()\n      .then((response) => this.setState({ categories: response }));\n  }\n\n  addItemCart(product) {\n    const currentCart = JSON.parse(localStorage.getItem('shoppingCart'));\n    const isOnCart = currentCart.some((item) => item.id === product.id);\n    if (isOnCart) {\n      currentCart.find((elem) => {\n        if (elem.id === product.id) {\n          const { quantity, available_quantity: availableQuantity } = elem;\n          if (quantity < availableQuantity) {\n            elem.quantity = quantity + 1;\n            localStorage.setItem('shoppingCart', JSON.stringify(currentCart));\n          }\n        }\n      });\n    } else {\n      product.quantity = 1;\n      const newCart = [...currentCart, product];\n      localStorage.setItem('shoppingCart', JSON.stringify(newCart));\n    }\n  }\n\n  async fetchApiSearch() {\n    const { searchText } = this.state;\n    const fetchList = await api.getProductsFromCategoryAndQuery('', searchText);\n\n    if (!fetchList.results.length) {\n      this.setState({\n        showMessage: true,\n      });\n    } else {\n      this.setState({\n        productsList: fetchList.results,\n        showMessage: false,\n      });\n    }\n  }\n\n  async fetchByCategoryId(categoryId) {\n    const fetchList = await api.getProductsFromCategoryAndQuery(categoryId, '');\n    this.setState({\n      productsList: fetchList.results,\n    });\n  }\n\n  handleSearchTextChange({ target }) {\n    const { value } = target;\n    this.setState({\n      searchText: value,\n    });\n  }\n\n  handleChange() {\n    const { hidden } = this.state;\n    this.setState({ hidden: !hidden });\n  }\n\n  toggle(product) {\n    const { toggle } = this.state;\n    this.addItemCart(product);\n    this.setState({ toggle: !toggle });\n  }\n\n  render() {\n    const shoppingCart = JSON.parse(localStorage.getItem('shoppingCart'));\n    const { productsList, showMessage, categories, hidden } = this.state;\n    const emptySearchMessage = <p>Nenhum produto foi encontrado</p>;\n    return (\n      <S.Main>\n        <S.Header>\n          <S.ButtonMenu\n            type=\"button\"\n            onClick={ this.handleChange }\n          >\n          </S.ButtonMenu>\n          <SearchBar\n            onSearchTextChange={ this.handleSearchTextChange }\n            onClickSearch={ this.fetchApiSearch }\n          />\n          <S.Div>\n            <Link to=\"/shopping-cart\">\n              <S.Span>{ shoppingCart !== null ? shoppingCart.length : 0 }</S.Span>\n              <S.CartIMG src={ Cart } alt=\"shopping cart\" />\n            </Link>\n          </S.Div>\n        </S.Header>\n        <ListOfCategories\n          categories={ categories }\n          hidden={ hidden }\n          onClickSelectedCategory={ this.fetchByCategoryId }\n        />\n        {\n          showMessage ? emptySearchMessage : <ProductCard\n            products={ productsList }\n            toggle={ this.toggle }\n          />\n        }\n      </S.Main>\n    );\n  }\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}